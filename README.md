# Dissertation_Product_Networks
Code and analysis for my dissertation on product network analysis as part of my dissertation
# Dissertation: Product Network Analysis and Regression Modelling

## Project Summary

This repository contains the full analysis for my dissertation, which investigates the drivers of product complementarity and substitutability. The project first replicates the network construction framework from Tian et al. (2021) to identify significant product relationships from transactional data. It then extends this work by using multiple regression models to explore how product-level attributes and network-level characteristics influence the strength of these relationships.

Please refer to Extracting Complements and Substitutes extracting complements and substitutes from sales data: a network perspective by Tian et al. (2021) for the exact steps on replicating. 

---

## Data Availability Statement 

**Please Note:** The raw transactional data used for this project is from the dunnhumby "carbo-loading" dataset and is governed by a license that prohibits redistribution. Therefore, the raw data **is not included** in this repository.

However, all necessary **intermediate data files** generated by the analysis are provided in the `/data_intermediate` folder. These files are sufficient to reproduce the final regression models presented in the dissertation.

---

## Methodology Overview

The analysis is conducted in a multi-step process, all contained within the single R script in the `/scripts` folder:

1.  **Bipartite Network Projection**: A bipartite network of transactions and products is built. The Bipartite Configuration Model (BiCM) is then used as a null model to identify statistically significant co-purchases, filtering out pairs that likely appear together by random chance. This results in two distinct networks: one for complementary products and one for substitutes.

2.  **Weighted Network Construction**: The binary networks are weighted. Complementarity is weighted using a cosine similarity variant, while substitutability is weighted based on the similarity of products' positions within the complement network.

3.  **Network Analysis**: Key node-level centrality measures (**node strength**, **betweenness centrality**, and **local clustering coefficient**) are calculated for every product within both the complement and substitute networks.

4.  **Regression Modelling**: The calculated network metrics are combined with product-level attributes (e.g., brand, category, price). A series of **Ordinary Least Squares (OLS)** and **Tobit regression models** are then run to determine which factors are significant predictors of complementarity and substitutability scores.

---

## Repository Structure

-   **/scripts/**: Contains the main R script for the entire analysis.
    -   `Network_construction_and_regression_analysis.r`: An all-in-one script that performs every step of the project, from the initial (non-runnable) data processing to the final, reproducible regression analysis.

-   **/data_intermediate/**: Contains the datasets generated by the first part of the script. These are required to run the regression analysis.
    -   `network_variables.csv`: A product-level dataset containing the calculated centrality scores for each network.
    -   `dv_iv_variables.xlsx`: The final, model-ready dataset containing all dependent and independent variables at the product-pair level.

-   **/output/**: Contains the final regression tables generated by the script.
    -   `complementarity_regression_OLS.html`: OLS model results for complementarity.
    -   `substitutability_regression_OLS.html`: OLS model results for substitutability.
    -   `tobit_models.html`: Tobit model results for both scores.

-   **/visualisations/**: Contains network graph visualisations.
    -   `community_network_comp.png`: Visual structure of the complementarity network.
    -   `community_network_subs.png`: Visual structure of the substitutability network.

---

## How to Reproduce the Analysis 

1.  **Prerequisites**: Ensure you have R and RStudio installed, along with the following key libraries: `dplyr`, `Matrix`, `igraph`, `AER`, and `stargazer`.

2.  **Set Working Directory**: Open the R script in RStudio. In the "Files" pane, navigate to the root folder of this project, click the "More" ⚙️ icon, and select **"Set as Working Directory"**.

3.  **Review and Run the Code**:
    -   The R script is heavily commented to align with the steps in the dissertation.
    -   The initial sections of the script (data loading and BiCM network creation) cannot be run without the private source data. These sections are included for **methodological review only**.
    -   The latter sections of the script, beginning with the loading of files from the `/data_intermediate` folder, **are fully runnable**. You can execute this part of the script to reproduce the OLS and Tobit models and generate the tables found in the `/output` folder.
